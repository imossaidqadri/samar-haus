<style>
/* Remove all vertical spacing from featured collection section */
.section {
  margin: 0 !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
}

/* Remove gaps and add borders for clean grid layout */
.section .grid {
  gap: 0 !important;
  grid-gap: 0 !important;
}

/* Add borders to each grid item */
.section .grid > div {
  border-right: 1px solid #e5e5e5;
  border-bottom: 1px solid #e5e5e5;
  margin: 0;
  padding: 0;
}

/* Remove right border from last items in each row */
.section .grid > div:nth-child(4n) {
  border-right: none;
}

/* Remove right border from last items on mobile (2 columns) */
@media (max-width: 767px) {
  .section .grid > div:nth-child(4n) {
    border-right: 1px solid #e5e5e5;
  }
  .section .grid > div:nth-child(2n) {
    border-right: none;
  }
}

/* Remove bottom border from last row items */
.section .grid > div:nth-last-child(-n+4) {
  border-bottom: none;
}

@media (max-width: 767px) {
  .section .grid > div:nth-last-child(-n+2) {
    border-bottom: none;
  }
}

/* Ensure product cards fill the space */
.section .grid > div > * {
  height: 100%;
  margin: 0;
  border-radius: 0 !important;
}

/* Product card content padding */
.section .grid .card__content,
.section .grid [class*="card"] > div:last-child {
  padding: 15px;
}
</style>
{%- liquid
  assign products_to_show = section.settings.products_to_show | default: 4
  assign columns_desktop = section.settings.columns_desktop | default: 4
  assign columns_mobile = section.settings.columns_mobile | default: 2
-%}

<section class='featured-collection-section {% if section.settings.full_width %}px-0{% else %}max-w-7xl mx-auto px-4{% endif %}'>
  {%- if section.settings.show_title and section.settings.title != blank -%}
    <div class='text-center mb-4'>
      <h2
        class='
          {% case section.settings.heading_size %}
            {% when 'h0' %}text-4xl md:text-5xl
            {% when 'h1' %}text-3xl md:text-4xl
            {% when 'h2' %}text-2xl md:text-3xl
            {% when 'hxl' %}text-5xl md:text-6xl
            {% when 'hxxl' %}text-6xl md:text-7xl
            {% else %}text-3xl md:text-4xl
          {% endcase %} font-light text-gray-900 tracking-tight
        '
      >
        {{ section.settings.title }}
      </h2>

      {%- if section.settings.show_description and section.settings.description != blank -%}
        <div
          class='
            mt-4 max-w-2xl mx-auto
            {% case section.settings.description_style %}
              {% when 'subtitle' %}text-lg text-gray-600
              {% when 'uppercase' %}text-sm uppercase tracking-wide text-gray-500
              {% else %}text-base text-gray-600
            {% endcase %}
          '
        >
          {{ section.settings.description }}
        </div>
      {%- endif -%}
    </div>
  {%- endif -%}

  {%- if section.settings.collection != blank -%}
    <div class='grid grid-cols-{{ columns_mobile }} md:grid-cols-{{ columns_desktop }}'>
      {%- for product in section.settings.collection.products limit: products_to_show -%}
        <div>
          {% render 'card-product',
            card_product: product,
            media_aspect_ratio: section.settings.image_ratio,
            image_shape: section.settings.image_shape,
            show_secondary_image: section.settings.show_secondary_image,
            show_vendor: section.settings.show_vendor,
            show_rating: section.settings.show_rating,
            section_id: section.id,
            quick_add: section.settings.quick_add
          %}
        </div>
      {%- endfor -%}
    </div>
  {%- else -%}
    {%- comment -%} Placeholder products when no collection is selected {%- endcomment -%}
    <div class='grid grid-cols-{{ columns_mobile }} md:grid-cols-{{ columns_desktop }}'>
      {%- for i in (1..products_to_show) -%}
        <div>
          {%- liquid
            assign placeholder_index = forloop.index
            if placeholder_index > 6
              assign placeholder_index = forloop.index | modulo: 6
              if placeholder_index == 0
                assign placeholder_index = 6
              endif
            endif
            assign placeholder_image = 'product-apparel-' | append: placeholder_index
          -%}
          {%
            render 'card-product',
            show_vendor: section.settings.show_vendor,
            media_aspect_ratio: section.settings.image_ratio,
            image_shape: section.settings.image_shape,
            placeholder_image: placeholder_image | placeholder_svg_tag,
            section_id: section.id
          %}
        </div>
      {%- endfor -%}
    </div>
  {%- endif -%}

  {%- if section.settings.show_view_all and section.settings.collection != blank -%}
    <div class='text-center mt-4'>
      <a
        href='{{ section.settings.collection.url }}'
        class='
          inline-flex items-center
          {% case section.settings.view_all_style %}
            {% when 'link' %}text-gray-900 hover:text-gray-700 font-medium underline underline-offset-4
            {% when 'outline' %}border border-gray-900 text-gray-900 hover:bg-gray-900 hover:text-white px-6 py-3 transition-colors duration-200
            {% when 'solid' %}bg-gray-900 text-white hover:bg-gray-800 px-6 py-3 transition-colors duration-200
          {% endcase %}
        '
      >
        {{ 'sections.featured_collection.view_all' | t }}
        <svg class='ml-2 w-4 h-4' fill='none' stroke='currentColor' viewBox='0 0 24 24'>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
      </a>
    </div>
  {%- endif -%}
</section>

{% schema %}
{
  "name": "Featured Collection",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "inline_richtext",
      "id": "title",
      "default": "Featured Collection",
      "label": "Heading"
    },
    {
      "type": "select",
      "id": "heading_size",
      "options": [
        {
          "value": "h2",
          "label": "Small"
        },
        {
          "value": "h1",
          "label": "Medium"
        },
        {
          "value": "h0",
          "label": "Large"
        },
        {
          "value": "hxl",
          "label": "Extra Large"
        },
        {
          "value": "hxxl",
          "label": "XXL"
        }
      ],
      "default": "h1",
      "label": "Heading size"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "checkbox",
      "id": "show_description",
      "label": "Show description",
      "default": false
    },
    {
      "type": "select",
      "id": "description_style",
      "label": "Description style",
      "options": [
        {
          "value": "body",
          "label": "Body"
        },
        {
          "value": "subtitle",
          "label": "Subtitle"
        },
        {
          "value": "uppercase",
          "label": "Uppercase"
        }
      ],
      "default": "body"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 4,
      "label": "Products to show"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 4,
      "label": "Desktop columns"
    },
    {
      "type": "select",
      "id": "columns_mobile",
      "default": "2",
      "label": "Mobile columns",
      "options": [
        {
          "value": "1",
          "label": "1 column"
        },
        {
          "value": "2",
          "label": "2 columns"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full width",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_title",
      "default": true,
      "label": "Show title"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "default": true,
      "label": "Show 'View all' button"
    },
    {
      "type": "select",
      "id": "view_all_style",
      "label": "View all style",
      "options": [
        {
          "value": "link",
          "label": "Link"
        },
        {
          "value": "outline",
          "label": "Outline button"
        },
        {
          "value": "solid",
          "label": "Solid button"
        }
      ],
      "default": "solid"
    },
    {
      "type": "header",
      "content": "Product cards"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "options": [
        {
          "value": "adapt",
          "label": "Adapt to image"
        },
        {
          "value": "portrait",
          "label": "Portrait"
        },
        {
          "value": "square",
          "label": "Square"
        }
      ],
      "default": "square",
      "label": "Image ratio"
    },
    {
      "type": "select",
      "id": "image_shape",
      "options": [
        {
          "value": "default",
          "label": "Default"
        },
        {
          "value": "arch",
          "label": "Arch"
        },
        {
          "value": "blob",
          "label": "Blob"
        },
        {
          "value": "round",
          "label": "Round"
        }
      ],
      "default": "default",
      "label": "Image shape"
    },
    {
      "type": "checkbox",
      "id": "show_secondary_image",
      "default": false,
      "label": "Show second product image on hover"
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "default": false,
      "label": "Show vendor"
    },
    {
      "type": "checkbox",
      "id": "show_rating",
      "default": false,
      "label": "Show product rating"
    },
    {
      "type": "select",
      "id": "quick_add",
      "default": "none",
      "label": "Quick add",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "standard",
          "label": "Standard"
        },
        {
          "value": "bulk",
          "label": "Bulk"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Featured Collection"
    }
  ]
}
{% endschema %}